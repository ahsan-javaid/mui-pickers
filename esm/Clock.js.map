{"version":3,"file":"Clock.js","sources":["../../src/views/Clock/ClockPointer.tsx","../../src/views/Clock/Clock.tsx"],"sourcesContent":["import * as React from 'react';\nimport clsx from 'clsx';\nimport ClockType, { ClockViewType } from '../../constants/ClockType';\nimport { Theme } from '@material-ui/core/styles';\nimport { withStyles, createStyles, WithStyles } from '@material-ui/core/styles';\n\nexport interface ClockPointerProps extends WithStyles<typeof styles> {\n  value: number;\n  hasSelected: boolean;\n  isInner: boolean;\n  type: ClockViewType;\n}\n\nexport class ClockPointer extends React.Component<ClockPointerProps> {\n  public static getDerivedStateFromProps = (\n    nextProps: ClockPointerProps,\n    state: ClockPointer['state']\n  ) => {\n    if (nextProps.type !== state.previousType) {\n      return {\n        toAnimateTransform: true,\n        previousType: nextProps.type,\n      };\n    }\n\n    return {\n      toAnimateTransform: false,\n      previousType: nextProps.type,\n    };\n  };\n\n  public state = {\n    toAnimateTransform: false,\n    previousType: undefined,\n  };\n\n  public getAngleStyle = () => {\n    const { value, isInner, type } = this.props;\n\n    const max = type === ClockType.HOURS ? 12 : 60;\n    let angle = (360 / max) * value;\n\n    if (type === ClockType.HOURS && value > 12) {\n      angle -= 360; // round up angle to max 360 degrees\n    }\n\n    return {\n      height: isInner ? '26%' : '40%',\n      transform: `rotateZ(${angle}deg)`,\n    };\n  };\n\n  public render() {\n    const { classes, hasSelected } = this.props;\n\n    return (\n      <div\n        style={this.getAngleStyle()}\n        className={clsx(classes.pointer, {\n          [classes.animateTransform]: this.state.toAnimateTransform,\n        })}\n      >\n        <div\n          className={clsx(classes.thumb, {\n            [classes.noPoint]: hasSelected,\n          })}\n        />\n      </div>\n    );\n  }\n}\n\nexport const styles = (theme: Theme) =>\n  createStyles({\n    pointer: {\n      width: 2,\n      backgroundColor: theme.palette.primary.main,\n      position: 'absolute',\n      left: 'calc(50% - 1px)',\n      bottom: '50%',\n      transformOrigin: 'center bottom 0px',\n    },\n    animateTransform: {\n      transition: theme.transitions.create(['transform', 'height']),\n    },\n    thumb: {\n      width: 4,\n      height: 4,\n      backgroundColor: theme.palette.primary.contrastText,\n      borderRadius: '100%',\n      position: 'absolute',\n      top: -21,\n      left: -15,\n      border: `14px solid ${theme.palette.primary.main}`,\n      boxSizing: 'content-box',\n    },\n    noPoint: {\n      backgroundColor: theme.palette.primary.main,\n    },\n  });\n\nexport default withStyles(styles, {\n  name: 'MuiPickersClockPointer',\n})(ClockPointer as React.ComponentType<ClockPointerProps>);\n","import * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport ClockPointer from './ClockPointer';\nimport ClockType, { ClockViewType } from '../../constants/ClockType';\nimport { getHours, getMinutes } from '../../_helpers/time-utils';\nimport { withStyles, createStyles, WithStyles, Theme } from '@material-ui/core/styles';\n\nexport interface ClockProps extends WithStyles<typeof styles> {\n  type: ClockViewType;\n  value: number;\n  onChange: (value: number, isFinish?: boolean) => void;\n  ampm?: boolean;\n  minutesStep?: number;\n  children: React.ReactElement<any>[];\n}\n\nexport class Clock extends React.Component<ClockProps> {\n  public static propTypes: any = {\n    type: PropTypes.oneOf(\n      Object.keys(ClockType).map(key => ClockType[key as keyof typeof ClockType])\n    ).isRequired,\n    value: PropTypes.number.isRequired,\n    onChange: PropTypes.func.isRequired,\n    children: PropTypes.arrayOf(PropTypes.node).isRequired,\n    ampm: PropTypes.bool,\n    minutesStep: PropTypes.number,\n    innerRef: PropTypes.any,\n  };\n\n  public static defaultProps = {\n    ampm: false,\n    minutesStep: 1,\n  };\n\n  public isMoving = false;\n\n  public setTime(e: any, isFinish = false) {\n    let { offsetX, offsetY } = e;\n\n    if (typeof offsetX === 'undefined') {\n      const rect = e.target.getBoundingClientRect();\n\n      offsetX = e.changedTouches[0].clientX - rect.left;\n      offsetY = e.changedTouches[0].clientY - rect.top;\n    }\n\n    const value =\n      this.props.type === ClockType.SECONDS || this.props.type === ClockType.MINUTES\n        ? getMinutes(offsetX, offsetY, this.props.minutesStep)\n        : getHours(offsetX, offsetY, Boolean(this.props.ampm));\n\n    this.props.onChange(value, isFinish);\n  }\n\n  public handleTouchMove = (e: React.TouchEvent) => {\n    this.isMoving = true;\n    this.setTime(e);\n  };\n\n  public handleTouchEnd = (e: React.TouchEvent) => {\n    if (this.isMoving) {\n      this.setTime(e, true);\n      this.isMoving = false;\n    }\n  };\n\n  public handleMove = (e: React.MouseEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    // MouseEvent.which is deprecated, but MouseEvent.buttons is not supported in Safari\n    const isButtonPressed =\n      typeof e.buttons === 'undefined' ? e.nativeEvent.which === 1 : e.buttons === 1;\n\n    if (isButtonPressed) {\n      this.setTime(e.nativeEvent, false);\n    }\n  };\n\n  public handleMouseUp = (e: React.MouseEvent) => {\n    if (this.isMoving) {\n      this.isMoving = false;\n    }\n\n    this.setTime(e.nativeEvent, true);\n  };\n\n  public hasSelected = () => {\n    const { type, value } = this.props;\n\n    if (type === ClockType.HOURS) {\n      return true;\n    }\n\n    return value % 5 === 0;\n  };\n\n  public render() {\n    const { classes, value, children, type, ampm } = this.props;\n\n    const isPointerInner = !ampm && type === ClockType.HOURS && (value < 1 || value > 12);\n\n    return (\n      <div className={classes.container}>\n        <div className={classes.clock}>\n          <div\n            role=\"menu\"\n            tabIndex={-1}\n            className={classes.squareMask}\n            onTouchMove={this.handleTouchMove}\n            onTouchEnd={this.handleTouchEnd}\n            onMouseUp={this.handleMouseUp}\n            onMouseMove={this.handleMove}\n          />\n\n          <div className={classes.pin} />\n\n          <ClockPointer\n            type={type}\n            value={value}\n            isInner={isPointerInner}\n            hasSelected={this.hasSelected()}\n          />\n\n          {children}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport const styles = (theme: Theme) =>\n  createStyles({\n    container: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'flex-end',\n      margin: `${theme.spacing(2)}px 0 ${theme.spacing(1)}px`,\n    },\n    clock: {\n      backgroundColor: 'rgba(0,0,0,.07)',\n      borderRadius: '50%',\n      height: 260,\n      width: 260,\n      position: 'relative',\n      pointerEvents: 'none',\n    },\n    squareMask: {\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      pointerEvents: 'auto',\n      outline: 'none',\n      touchActions: 'none',\n      userSelect: 'none',\n      '&:active': {\n        cursor: 'move',\n      },\n    },\n    pin: {\n      width: 6,\n      height: 6,\n      borderRadius: '50%',\n      backgroundColor: theme.palette.primary.main,\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)',\n    },\n  });\n\nexport default withStyles(styles, {\n  name: 'MuiPickersClock',\n})(Clock as React.ComponentType<ClockProps>);\n"],"names":["ClockPointer","state","toAnimateTransform","previousType","undefined","getAngleStyle","props","value","isInner","type","max","ClockType","HOURS","angle","height","transform","classes","hasSelected","React.createElement","clsx","pointer","animateTransform","thumb","noPoint","React","getDerivedStateFromProps","nextProps","styles","theme","createStyles","width","backgroundColor","palette","primary","main","position","left","bottom","transformOrigin","transition","transitions","create","contrastText","borderRadius","top","border","boxSizing","withStyles","name","Clock","isMoving","handleTouchMove","e","setTime","handleTouchEnd","handleMove","preventDefault","stopPropagation","isButtonPressed","buttons","nativeEvent","which","handleMouseUp","isFinish","offsetX","offsetY","rect","target","getBoundingClientRect","changedTouches","clientX","clientY","SECONDS","MINUTES","getMinutes","minutesStep","getHours","Boolean","ampm","onChange","children","isPointerInner","container","clock","squareMask","pin","propTypes","PropTypes","Object","keys","map","key","isRequired","innerRef","defaultProps","display","justifyContent","alignItems","margin","spacing","pointerEvents","outline","touchActions","userSelect","cursor"],"mappings":";;;;;;;;;;;IAaaA,YAAb;EAAA;;EAAA;IAAA;;IAAA;;IAAA;;IAAA;MAAA;;;IAAA;IAAA,MAkBSC,KAlBT,GAkBiB;MACbC,kBAAkB,EAAE,KADP;MAEbC,YAAY,EAAEC;KApBlB;;IAAA,MAuBSC,aAvBT,GAuByB,YAAM;MAAA,kBACM,MAAKC,KADX;UACnBC,KADmB,eACnBA,KADmB;UACZC,OADY,eACZA,OADY;UACHC,IADG,eACHA,IADG;MAG3B,IAAMC,GAAG,GAAGD,IAAI,KAAKE,SAAS,CAACC,KAAnB,GAA2B,EAA3B,GAAgC,EAA5C;MACA,IAAIC,KAAK,GAAI,MAAMH,GAAP,GAAcH,KAA1B;;MAEA,IAAIE,IAAI,KAAKE,SAAS,CAACC,KAAnB,IAA4BL,KAAK,GAAG,EAAxC,EAA4C;QAC1CM,KAAK,IAAI,GAAT,CAD0C;;;MAI5C,OAAO;QACLC,MAAM,EAAEN,OAAO,GAAG,KAAH,GAAW,KADrB;QAELO,SAAS,oBAAaF,KAAb;OAFX;KAjCJ;;IAAA;;;EAAA;IAAA;IAAA,yBAuCkB;MAAA,mBACmB,KAAKP,KADxB;UACNU,OADM,gBACNA,OADM;UACGC,WADH,gBACGA,WADH;MAGd,OACEC;QACE,KAAK,EAAE,KAAKb,aAAL,EADT;QAEE,SAAS,EAAEc,IAAI,CAACH,OAAO,CAACI,OAAT,EACe,KAAKnB,KAAL,CAAWC,kBAD1B,IACZc,OAAO,CAACK,gBADI;SAIfH;QACE,SAAS,EAAEC,IAAI,CAACH,OAAO,CAACM,KAAT,EACML,WADN,IACZD,OAAO,CAACO,OADI;QAPnB,CADF;;;;EA1CJ;EAAkCC,SAAlC;;AAAaxB,aACGyB,2BAA2B,UACvCC,SADuC,EAEvCzB,KAFuC,EAGpC;EACH,IAAIyB,SAAS,CAACjB,IAAV,KAAmBR,KAAK,CAACE,YAA7B,EAA2C;IACzC,OAAO;MACLD,kBAAkB,EAAE,IADf;MAELC,YAAY,EAAEuB,SAAS,CAACjB;KAF1B;;;EAMF,OAAO;IACLP,kBAAkB,EAAE,KADf;IAELC,YAAY,EAAEuB,SAAS,CAACjB;GAF1B;;;AA+CJ,AAAO,IAAMkB,MAAM,GAAG,SAATA,MAAS,CAACC,KAAD;EAAA,OACpBC,YAAY,CAAC;IACXT,OAAO,EAAE;MACPU,KAAK,EAAE,CADA;MAEPC,eAAe,EAAEH,KAAK,CAACI,OAAN,CAAcC,OAAd,CAAsBC,IAFhC;MAGPC,QAAQ,EAAE,UAHH;MAIPC,IAAI,EAAE,iBAJC;MAKPC,MAAM,EAAE,KALD;MAMPC,eAAe,EAAE;KAPR;IASXjB,gBAAgB,EAAE;MAChBkB,UAAU,EAAEX,KAAK,CAACY,WAAN,CAAkBC,MAAlB,CAAyB,CAAC,WAAD,EAAc,QAAd,CAAzB;KAVH;IAYXnB,KAAK,EAAE;MACLQ,KAAK,EAAE,CADF;MAELhB,MAAM,EAAE,CAFH;MAGLiB,eAAe,EAAEH,KAAK,CAACI,OAAN,CAAcC,OAAd,CAAsBS,YAHlC;MAILC,YAAY,EAAE,MAJT;MAKLR,QAAQ,EAAE,UALL;MAMLS,GAAG,EAAE,CAAC,EAND;MAOLR,IAAI,EAAE,CAAC,EAPF;MAQLS,MAAM,uBAAgBjB,KAAK,CAACI,OAAN,CAAcC,OAAd,CAAsBC,IAAtC,CARD;MASLY,SAAS,EAAE;KArBF;IAuBXvB,OAAO,EAAE;MACPQ,eAAe,EAAEH,KAAK,CAACI,OAAN,CAAcC,OAAd,CAAsBC;;GAxB/B,CADQ;CAAf;AA6BP,qBAAea,UAAU,CAACpB,MAAD,EAAS;EAChCqB,IAAI,EAAE;CADiB,CAAV,CAEZhD,YAFY,CAAf;;ICrFaiD,KAAb;EAAA;;EAAA;IAAA;;IAAA;;IAAA;;IAAA;MAAA;;;IAAA;IAAA,MAkBSC,QAlBT,GAkBoB,KAlBpB;;IAAA,MAsCSC,eAtCT,GAsC2B,UAACC,CAAD,EAAyB;MAChD,MAAKF,QAAL,GAAgB,IAAhB;;MACA,MAAKG,OAAL,CAAaD,CAAb;KAxCJ;;IAAA,MA2CSE,cA3CT,GA2C0B,UAACF,CAAD,EAAyB;MAC/C,IAAI,MAAKF,QAAT,EAAmB;QACjB,MAAKG,OAAL,CAAaD,CAAb,EAAgB,IAAhB;;QACA,MAAKF,QAAL,GAAgB,KAAhB;;KA9CN;;IAAA,MAkDSK,UAlDT,GAkDsB,UAACH,CAAD,EAAyC;MAC3DA,CAAC,CAACI,cAAF;MACAJ,CAAC,CAACK,eAAF,GAF2D;;MAI3D,IAAMC,eAAe,GACnB,OAAON,CAAC,CAACO,OAAT,KAAqB,WAArB,GAAmCP,CAAC,CAACQ,WAAF,CAAcC,KAAd,KAAwB,CAA3D,GAA+DT,CAAC,CAACO,OAAF,KAAc,CAD/E;;MAGA,IAAID,eAAJ,EAAqB;QACnB,MAAKL,OAAL,CAAaD,CAAC,CAACQ,WAAf,EAA4B,KAA5B;;KA1DN;;IAAA,MA8DSE,aA9DT,GA8DyB,UAACV,CAAD,EAAyB;MAC9C,IAAI,MAAKF,QAAT,EAAmB;QACjB,MAAKA,QAAL,GAAgB,KAAhB;;;MAGF,MAAKG,OAAL,CAAaD,CAAC,CAACQ,WAAf,EAA4B,IAA5B;KAnEJ;;IAAA,MAsES3C,WAtET,GAsEuB,YAAM;MAAA,kBACD,MAAKX,KADJ;UACjBG,IADiB,eACjBA,IADiB;UACXF,KADW,eACXA,KADW;;MAGzB,IAAIE,IAAI,KAAKE,SAAS,CAACC,KAAvB,EAA8B;QAC5B,OAAO,IAAP;;;MAGF,OAAOL,KAAK,GAAG,CAAR,KAAc,CAArB;KA7EJ;;IAAA;;;EAAA;IAAA;IAAA,wBAoBiB6C,CApBjB,EAoB2C;MAAA,IAAlBW,QAAkB,uEAAP,KAAO;MAAA,IACjCC,OADiC,GACZZ,CADY,CACjCY,OADiC;UACxBC,OADwB,GACZb,CADY,CACxBa,OADwB;;MAGvC,IAAI,OAAOD,OAAP,KAAmB,WAAvB,EAAoC;QAClC,IAAME,IAAI,GAAGd,CAAC,CAACe,MAAF,CAASC,qBAAT,EAAb;QAEAJ,OAAO,GAAGZ,CAAC,CAACiB,cAAF,CAAiB,CAAjB,EAAoBC,OAApB,GAA8BJ,IAAI,CAAC9B,IAA7C;QACA6B,OAAO,GAAGb,CAAC,CAACiB,cAAF,CAAiB,CAAjB,EAAoBE,OAApB,GAA8BL,IAAI,CAACtB,GAA7C;;;MAGF,IAAMrC,KAAK,GACT,KAAKD,KAAL,CAAWG,IAAX,KAAoBE,SAAS,CAAC6D,OAA9B,IAAyC,KAAKlE,KAAL,CAAWG,IAAX,KAAoBE,SAAS,CAAC8D,OAAvE,GACIC,UAAU,CAACV,OAAD,EAAUC,OAAV,EAAmB,KAAK3D,KAAL,CAAWqE,WAA9B,CADd,GAEIC,QAAQ,CAACZ,OAAD,EAAUC,OAAV,EAAmBY,OAAO,CAAC,KAAKvE,KAAL,CAAWwE,IAAZ,CAA1B,CAHd;MAKA,KAAKxE,KAAL,CAAWyE,QAAX,CAAoBxE,KAApB,EAA2BwD,QAA3B;;;IAnCJ;IAAA,yBAgFkB;MAAA,mBACmC,KAAKzD,KADxC;UACNU,OADM,gBACNA,OADM;UACGT,KADH,gBACGA,KADH;UACUyE,QADV,gBACUA,QADV;UACoBvE,IADpB,gBACoBA,IADpB;UAC0BqE,IAD1B,gBAC0BA,IAD1B;MAGd,IAAMG,cAAc,GAAG,CAACH,IAAD,IAASrE,IAAI,KAAKE,SAAS,CAACC,KAA5B,KAAsCL,KAAK,GAAG,CAAR,IAAaA,KAAK,GAAG,EAA3D,CAAvB;MAEA,OACEW;QAAK,SAAS,EAAEF,OAAO,CAACkE;SACtBhE;QAAK,SAAS,EAAEF,OAAO,CAACmE;SACtBjE;QACE,IAAI,EAAC,MADP;QAEE,QAAQ,EAAE,CAAC,CAFb;QAGE,SAAS,EAAEF,OAAO,CAACoE,UAHrB;QAIE,WAAW,EAAE,KAAKjC,eAJpB;QAKE,UAAU,EAAE,KAAKG,cALnB;QAME,SAAS,EAAE,KAAKQ,aANlB;QAOE,WAAW,EAAE,KAAKP;QARtB,EAWErC;QAAK,SAAS,EAAEF,OAAO,CAACqE;QAX1B,EAaEnE,cAAClB,cAAD;QACE,IAAI,EAAES,IADR;QAEE,KAAK,EAAEF,KAFT;QAGE,OAAO,EAAE0E,cAHX;QAIE,WAAW,EAAE,KAAKhE,WAAL;QAjBjB,EAoBG+D,QApBH,CADF,CADF;;;;EArFJ;EAA2BxD,SAA3B;wCAAayB,MACGqC,YAAiB;EAC7B7E,IAAI,EAAE8E,KAAA,CACJC,MAAM,CAACC,IAAP,CAAY9E,SAAZ,EAAuB+E,GAAvB,CAA2B,UAAAC,GAAG;IAAA,OAAIhF,SAAS,CAACgF,GAAD,CAAb;GAA9B,CADI,EAEJC,UAH2B;EAI7BrF,KAAK,EAAEgF,MAAA,CAAiBK,UAJK;EAK7Bb,QAAQ,EAAEQ,IAAA,CAAeK,UALI;EAM7BZ,QAAQ,EAAEO,OAAA,CAAkBA,IAAlB,EAAkCK,UANf;EAO7Bd,IAAI,EAAES,IAPuB;EAQ7BZ,WAAW,EAAEY,MARgB;EAS7BM,QAAQ,EAAEN;;AAVDtC,MAaG6C,eAAe;EAC3BhB,IAAI,EAAE,KADqB;EAE3BH,WAAW,EAAE;;AAmGjB,IAAahD,QAAM,GAAG,SAATA,MAAS,CAACC,KAAD;EAAA,OACpBC,YAAY,CAAC;IACXqD,SAAS,EAAE;MACTa,OAAO,EAAE,MADA;MAETC,cAAc,EAAE,QAFP;MAGTC,UAAU,EAAE,UAHH;MAITC,MAAM,YAAKtE,KAAK,CAACuE,OAAN,CAAc,CAAd,CAAL,kBAA6BvE,KAAK,CAACuE,OAAN,CAAc,CAAd,CAA7B;KALG;IAOXhB,KAAK,EAAE;MACLpD,eAAe,EAAE,iBADZ;MAELY,YAAY,EAAE,KAFT;MAGL7B,MAAM,EAAE,GAHH;MAILgB,KAAK,EAAE,GAJF;MAKLK,QAAQ,EAAE,UALL;MAMLiE,aAAa,EAAE;KAbN;IAeXhB,UAAU,EAAE;MACVtD,KAAK,EAAE,MADG;MAEVhB,MAAM,EAAE,MAFE;MAGVqB,QAAQ,EAAE,UAHA;MAIViE,aAAa,EAAE,MAJL;MAKVC,OAAO,EAAE,MALC;MAMVC,YAAY,EAAE,MANJ;MAOVC,UAAU,EAAE,MAPF;MAQV,YAAY;QACVC,MAAM,EAAE;;KAxBD;IA2BXnB,GAAG,EAAE;MACHvD,KAAK,EAAE,CADJ;MAEHhB,MAAM,EAAE,CAFL;MAGH6B,YAAY,EAAE,KAHX;MAIHZ,eAAe,EAAEH,KAAK,CAACI,OAAN,CAAcC,OAAd,CAAsBC,IAJpC;MAKHC,QAAQ,EAAE,UALP;MAMHS,GAAG,EAAE,KANF;MAOHR,IAAI,EAAE,KAPH;MAQHrB,SAAS,EAAE;;GAnCH,CADQ;CAAf;AAwCP,cAAegC,UAAU,CAACpB,QAAD,EAAS;EAChCqB,IAAI,EAAE;CADiB,CAAV,CAEZC,KAFY,CAAf;;;;;"}